    - name: Set nginx default configuration...
      template:
        src: "{{ item.source }}"
        dest: "{{ item.dest }}"
        backup: true
      loop:
        - { source: 'templates/nginx_main_conf.j2', dest: '/etc/nginx/nginx.conf' }
        - { source: 'templates/ssl_conf.j2', dest: '/etc/nginx/ssl.conf' }
        - { source: 'templates/header_conf.j2', dest: '/etc/nginx/header.conf' }
        - { source: 'templates/proxy_conf.j2', dest: '/etc/nginx/proxy.conf' }
        - { source: 'templates/optimization_conf.j2', dest: '/etc/nginx/optimization.conf' }
        - { source: 'templates/php_optimization_conf.j2', dest: '/etc/nginx/php_optimization.conf' }
        - { source: 'templates/conf.d/default_conf.j2', dest: '/etc/nginx/conf.d/default.conf' }
        - { source: 'templates/conf.d/letsencrypt_conf.j2', dest: '/etc/nginx/conf.d/letsencrypt.conf' }
        - { source: 'templates/sites-available/nextcloud_conf.j2', dest: '/etc/nginx/sites-available/nextcloud.conf' }
        - { source: 'templates/conf.d/stub_status_conf.j2', dest: '/etc/nginx/conf.d/stub_status.conf' }
      register: nginx_config

    - name: Symlink nginx nextcloud config from sites-available to sites-enabled...
      file:
        src: '../sites-available/nextcloud.conf'
        dest: '/etc/nginx/sites-enabled/nextcloud.conf'
        state: link

